% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/oasis_glue.R
\name{.lss_oasis}
\alias{.lss_oasis}
\title{OASIS backend for fmrilss::lss (internal entry)}
\usage{
.lss_oasis(Y, X = NULL, Z = NULL, Nuisance = NULL, oasis = list())
}
\arguments{
\item{Y}{(T x V) numeric matrix}

\item{X}{(T x N_trials) trial-wise design (if NULL, use oasis$design_spec to build)}

\item{Z}{(T x K) fixed experimental regressors to be projected out}

\item{Nuisance}{(T x P) confounds (intercept, motion, drift, aCompCor, ...)}

\item{oasis}{list of options:
- design_spec: list describing events/HRF to build X via fmrihrf
- K: explicit basis dimension (auto-detected if not provided)
- ridge_mode: "absolute" (default) or "fractional"
- ridge_x, ridge_b: nonnegative ridge on the [a_j, b_j] Gram (default 0 -> exact LSS)
- block_cols: voxel block size (default 4096)
- return_se: logical (default FALSE)
- return_diag: logical (default FALSE)
- whiten: "none" | "ar1" (default "none"); if "ar1", prewhiten Y and design first}
}
\value{
by default: (N_trials x V) matrix of betas; if `return_se` or `return_diag`, a list
}
\description{
Add `method="oasis"` to fmrilss::lss(). This path:
  - (optionally) builds trial-wise design X via fmrihrf
  - residualizes Y (and X downstream) against confounds + Z + other-condition aggregates
  - computes all trial betas in one batched pass via the closed-form LSS (exact; or ridge-LSS)
  - optionally returns per-trial SEs and design diagnostics
}
\keyword{internal}
