% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/item_compute_u.R
\name{item_compute_u}
\alias{item_compute_u}
\title{Compute ITEM trial covariance matrix}
\usage{
item_compute_u(
  X_t,
  V = NULL,
  v_type = c("cov", "precision"),
  ridge = 0,
  method = c("chol", "svd", "pinv"),
  run_id = NULL,
  output = c("matrix", "by_run"),
  tol = sqrt(.Machine$double.eps)
)
}
\arguments{
\item{X_t}{Numeric trial-wise design matrix (`n_time x n_trials`).}

\item{V}{Optional temporal covariance/precision object.
Accepted forms:
- `NULL` (identity),
- dense/sparse matrix (`n_time x n_time`),
- run-block list of square matrices whose block sizes sum to `n_time`.}

\item{v_type}{Whether `V` is covariance (`"cov"`) or precision (`"precision"`).}

\item{ridge}{Non-negative ridge term added to `X_t' V^{-1} X_t`.}

\item{method}{Preferred solver path (`"chol"`, `"svd"`, or `"pinv"`).}

\item{run_id}{Optional trial-level run ids (length `n_trials`). Required only
when `output = "by_run"`.}

\item{output}{Return full `U` (`"matrix"`) or split run blocks (`"by_run"`).}

\item{tol}{Numerical tolerance for rank/solver fallbacks.}
}
\value{
Numeric matrix `U` by default, or a named list `U_by_run` when
  `output = "by_run"`. Returned object includes `item_diagnostics` attribute
  with rank/condition/solver details.
}
\description{
Compute the trial covariance term
`U = (X_t' V^{-1} X_t + ridge * I)^{-1}`
using stable solve paths with fallbacks.
}
