% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prewhitening.R
\name{.prewhiten_data}
\alias{.prewhiten_data}
\title{Prewhiten fMRI data using AR/ARMA models}
\usage{
.prewhiten_data(Y, X = NULL, Z = NULL, Nuisance = NULL, prewhiten = list())
}
\arguments{
\item{Y}{Numeric matrix (timepoints x voxels) of fMRI data}

\item{X}{Optional design matrix for trials (timepoints x trials)}

\item{Z}{Optional experimental design matrix (timepoints x regressors)}

\item{Nuisance}{Optional nuisance regressors (timepoints x nuisance)}

\item{prewhiten}{List of prewhitening options:
\describe{
  \item{method}{Character: "ar" (default), "arma", or "none"}
  \item{p}{Integer or "auto": AR order (default "auto")}
  \item{q}{Integer: MA order for ARMA (default 0)}
  \item{p_max}{Integer: Maximum AR order when p="auto" (default 6)}
  \item{pooling}{Character: "global" (default), "voxel", "run", or "parcel"}
  \item{runs}{Integer vector: Run identifiers for run-aware estimation}
  \item{parcels}{Integer vector: Parcel memberships for parcel-based pooling}
  \item{exact_first}{Character: "ar1" or "none" for exact AR(1) scaling}
  \item{compute_residuals}{Logical: Whether to compute residuals first (default TRUE)}
}}
}
\value{
List containing:
  \describe{
    \item{Y_whitened}{Whitened data matrix}
    \item{X_whitened}{Whitened trial design matrix (if provided)}
    \item{Z_whitened}{Whitened experimental design (if provided)}
    \item{Nuisance_whitened}{Whitened nuisance regressors (if provided)}
    \item{whiten_plan}{fmriAR plan object for diagnostics}
    \item{applied}{Logical: Whether whitening was applied}
  }
}
\description{
Internal function providing a unified interface for prewhitening fMRI data
using the fmriAR package. Supports various AR/ARMA models with flexible
parameter estimation strategies.
}
\keyword{internal}
