% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/voxel_hrf.R
\name{estimate_voxel_hrf}
\alias{estimate_voxel_hrf}
\title{Estimate Voxel-wise HRF Basis Coefficients}
\usage{
estimate_voxel_hrf(Y, events, basis, nuisance_regs = NULL)
}
\arguments{
\item{Y}{Numeric matrix of BOLD data (time x voxels).}

\item{events}{Data frame with \code{onset}, \code{duration} and \code{condition} columns.}

\item{basis}{HRF object from the \code{fmrihrf} package.}

\item{nuisance_regs}{Optional numeric matrix of nuisance regressors.}
}
\value{
A \link{VoxelHRF} object containing at least:
  \item{coefficients}{Matrix of HRF basis coefficients.}
  \item{basis}{The HRF basis object used.}
  \item{conditions}{Character vector of modeled conditions.}
}
\description{
Fits a GLM to estimate HRF basis coefficients for every voxel.
}
\examples{
\dontrun{
set.seed(1)
Y <- matrix(rnorm(100), 50, 2)
events <- data.frame(onset = c(5, 25), duration = 1,
                     condition = "A")
basis <- fmrihrf::hrf_gamma()
sframe <- fmrihrf::sampling_frame(blocklens = nrow(Y), TR = 1)
times <- fmrihrf::samples(sframe, global = TRUE)
rset <- fmrihrf::regressor_set(onsets = events$onset,
                               fac = factor(1:nrow(events)),
                               hrf = basis, duration = events$duration,
                               span = 30)
X <- fmrihrf::evaluate(rset, grid = times, precision = 0.1, method = "conv")
coef <- matrix(rnorm(ncol(X) * ncol(Y)), ncol(X), ncol(Y))
Y <- X \%*\% coef + Y * 0.1
est <- estimate_voxel_hrf(Y, events, basis)
str(est)
}
}
